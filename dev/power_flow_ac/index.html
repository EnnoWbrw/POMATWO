<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>AC Power Flow · POMATWO.jl</title><meta name="title" content="AC Power Flow · POMATWO.jl"/><meta property="og:title" content="AC Power Flow · POMATWO.jl"/><meta property="twitter:title" content="AC Power Flow · POMATWO.jl"/><meta name="description" content="Documentation for POMATWO.jl."/><meta property="og:description" content="Documentation for POMATWO.jl."/><meta property="twitter:description" content="Documentation for POMATWO.jl."/><meta property="og:url" content="https://ennowbrw.github.io/POMATWO/power_flow_ac/"/><meta property="twitter:url" content="https://ennowbrw.github.io/POMATWO/power_flow_ac/"/><link rel="canonical" href="https://ennowbrw.github.io/POMATWO/power_flow_ac/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">POMATWO.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">Model Data</span><ul><li><a class="tocitem" href="../input_data/">Input Data</a></li><li><a class="tocitem" href="../output_data/">Output Data</a></li></ul></li><li><span class="tocitem">Model Configuration</span><ul><li><a class="tocitem" href="../market_definitions/">Market Definition</a></li><li><a class="tocitem" href="../Model_config/">Model Creation</a></li></ul></li><li><span class="tocitem">Mathematical Model</span><ul><li><a class="tocitem" href="../nomenclature/">Nomenclature</a></li><li><a class="tocitem" href="../market_model/">Market Model</a></li><li class="is-active"><a class="tocitem" href>AC Power Flow</a><ul class="internal"><li><a class="tocitem" href="#DC-Power-Flow-Assumptions"><span>DC Power Flow Assumptions</span></a></li><li><a class="tocitem" href="#Model-Integration"><span>Model Integration</span></a></li><li><a class="tocitem" href="#PTDF-Matrix-Formulation"><span>PTDF-Matrix Formulation</span></a></li></ul></li></ul></li><li><span class="tocitem">Visualization</span><ul><li><a class="tocitem" href="../Visualizing_inputs/">Visualizing inputs</a></li><li><a class="tocitem" href="../Visualizing_outputs/">Visualizing outputs</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Mathematical Model</a></li><li class="is-active"><a href>AC Power Flow</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>AC Power Flow</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/EnnoWbrw/POMATWO" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/EnnoWbrw/POMATWO/blob/main/docs/src/power_flow_ac.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="3.-AC-Power-Flow-Linearization"><a class="docs-heading-anchor" href="#3.-AC-Power-Flow-Linearization">3. AC Power Flow Linearization</a><a id="3.-AC-Power-Flow-Linearization-1"></a><a class="docs-heading-anchor-permalink" href="#3.-AC-Power-Flow-Linearization" title="Permalink"></a></h1><p>The apparent power flow from one node to another can be divided into active and reactive power:</p><p class="math-container">\[\begin{aligned}
    P_{n,m} &amp;= \lvert \underline{U}_n^2 \rvert \cdot g_{n,m} - \lvert U_n \rvert \cdot \lvert U_m \rvert \cdot g_{n,m} \cdot \cos{\theta_{n,m}} - \lvert U_n \rvert \cdot \lvert U_m \rvert \cdot b_{n,m} \sin{\theta_{n,m}}\\
    Q_{n,m} &amp;= - \lvert \underline{U}_n^2 \rvert \cdot b_{n,m} + \lvert U_n \rvert \cdot \lvert U_m \rvert \cdot b_{n,m} \cdot \cos{\theta_{n,m}} - \lvert U_n \rvert \cdot \lvert U_m \rvert \cdot g_{n,m} \sin{\theta_{n,m}}
\end{aligned}\]</p><h2 id="DC-Power-Flow-Assumptions"><a class="docs-heading-anchor" href="#DC-Power-Flow-Assumptions">DC Power Flow Assumptions</a><a id="DC-Power-Flow-Assumptions-1"></a><a class="docs-heading-anchor-permalink" href="#DC-Power-Flow-Assumptions" title="Permalink"></a></h2><p>For the linearization of power flows in the AC network, the reactive power component <span>$Q$</span> is neglected, the reasoning behind this is given below. The following three assumptions are necessary:</p><ol><li><span>$g = 0$</span> and <span>$b = \frac{-1}{X}$</span></li><li><span>$\cos(\theta_{n,m}) = 1$</span> and <span>$\sin(\theta_{n,m}) = \theta_{n,m}$</span></li><li><span>$|U_n| = |U_m| = 1$</span> (per-unit system)</li></ol><p>Assumption 1 is based on the observation that the ohmic resistance <span>$R$</span> in the transmission network is significantly smaller than the reactance <span>$X$</span>. Recall that for the impedance <span>$\underline{Z}$</span>:</p><p class="math-container">\[\underline{Z} = R + jX\]</p><p>By rearranging the equations:</p><p class="math-container">\[\underline{Y} = \frac{1}{\underline{Z}} = \frac{1}{R + jX} = g + jb\]</p><p>we obtain:</p><p class="math-container">\[g = \frac{R}{R^2+X^2}\qquad b = \frac{-X}{R^2+X^2}\]</p><p>When <span>$R \ll X$</span>, these terms simplify to: <span>$g = 0$</span> and <span>$b = \frac{-1}{x\_{n,m}}$</span>.</p><p>Thus, the equations simplify to:</p><p class="math-container">\[\begin{aligned}
    P_{n,m} &amp;= - b_{n,m} \cdot |U_n| \cdot |U_m|  \sin(\theta_{n,m}) \\
    &amp;= \frac{1}{x_{n,m}} \cdot |U_n| \cdot |U_m|  \sin(\theta_{n,m}) \\
    Q_{n,m} &amp;= - b_{n,m} \cdot |\underline{U}_n^2| +  b_{n,m} \cdot |U_n| \cdot |U_m| \cdot \cos(\theta_{n,m}) \\
    &amp;= \frac{1}{x_{n,m}} \cdot |\underline{U}_n^2| -  \frac{1}{x_{n,m}} \cdot |U_n| \cdot |U_m| \cdot \cos(\theta_{n,m})
\end{aligned}\]</p><p>Assumption 2 is based on the observation that the phase angle difference <span>$\theta\_{n,m}$</span> is very small. The cosine of <span>$\theta$</span> converges to 1 as <span>$\theta$</span>approaches 0. The small-angle approximation states that <span>$\sin(\theta) \approx \theta$</span>for very small <span>$\theta\$</span> (in radians).</p><p>With the small-angle approximation, the above equations further simplify to:</p><p class="math-container">\[\begin{aligned}
    P_{n,m} &amp;= \frac{1}{x_{n,m}} \cdot |U_n| \cdot |U_m| \cdot  \theta_{n,m} \\
    Q_{n,m} &amp;= \frac{1}{x_{n,m}} \cdot |\underline{U}_n^2| -  \frac{1}{x_{n,m}} \cdot |U_n| \cdot |U_m|
\end{aligned}\]</p><p>Assumption 3 implies that the node voltages rarely deviate from their design values and only by a small amount. In the per-unit system, the magnitudes of the node voltages are therefore very close to 1.</p><p>By substituting Assumption 3 into the previous equations, the linearized equations for power transmission are obtained:</p><p class="math-container">\[\begin{aligned}
    P_{n,m} &amp;= \frac{1}{x_{n,m}} \cdot \theta_{n,m} \\
    Q_{n,m} &amp;= \frac{1}{x_{n,m}} -  \frac{1}{x_{n,m}} = 0
\end{aligned}\]</p><p>For the active nodal power:</p><p class="math-container">\[P_n = \sum_{m}^N\frac{1}{x_{n,m}}\cdot \theta_{n,m}\]</p><h2 id="Model-Integration"><a class="docs-heading-anchor" href="#Model-Integration">Model Integration</a><a id="Model-Integration-1"></a><a class="docs-heading-anchor-permalink" href="#Model-Integration" title="Permalink"></a></h2><p>With the active power flow <span>$P_{n,m}$</span> from node <span>$n$</span> to node <span>$m$</span> and the net power input at node <span>$n$</span> called <span>$P_n$</span>. In this formulation the line parameter <span>$x_{n,m}$</span> representing the line reactance is static, i.e. not time dependent. This is often done in power system modeling. The whole power flow problem depicted in Equations (see formulas below) is dependent on the variable <span>$\theta_{n,m}$</span>, which represents the phase angle difference between two connected nodes. The equations can be transformed to represent actual power flows on line <span>$l$</span> and nodal net power injections into node <span>$n$</span> by using two matrices that capture grid topology and line parameters. Additionally, line limitations can be considered by adding equation for <span>$f_l^{max}$</span>.</p><p class="math-container">\[F_{l} = \sum_n^N \text{B}_{l\times n}^{line} \cdot \theta_{n} \qquad \forall l \in L \\
INJ_n = \sum_m^N \text{B}_{n \times m}^{bus} \cdot \theta_{m} \qquad \forall n \in N \\
INJ_n = \sum_l^L \text{A}_{l\times n} \cdot F_{l} \qquad \forall n \in N \\
-f_l^{max} \leq F_{l} \leq f_l^{max} \qquad \forall l \in L \\
\theta_{n=slack} = 0\]</p><p>Implementing a reference node, often referred to as a &quot;slack node&quot;, with a fixed nodal phase angle of <span>$\theta_{n=slack} = 0$</span> allows a simplification of the phase angle difference <span>$\theta_{n,m}$</span> to the nodal phase angle difference <span>$\theta_n$</span>. The nodal phase angles are all in reference to the one common slack node. The entire load flow problem then only contains one decision variable for each node, which significantly decreases model complexity.</p><p>The slack node can be chosen at random within the connected system.</p><p>The line susceptance matrix <span>$\text{B}_{l\times n}^{line}$</span> is an <span>$l \times n$</span> matrix, that can be created from a diagonalized vector of line susceptances <span>$\text{B}_{l,l}^d$</span> multiplied by the incidence matrix <span>$\text{A}_{l\times n}$</span>.</p><p>The bus susceptance matrix <span>$\text{B}_{n \times m}^{bus}$</span> can be created by multiplying the transposed line susceptance matrix with the incidence matrix.</p><p class="math-container">\[\text{B}_{l\times n}^{line} = \text{B}_{l,l}^d \cdot \text{A}_{l\times n} \\
\text{B}_{n \times m}^{bus} = \text{A}_{l\times n}^T \cdot \text{B}_{l,l}^d \cdot \text{A}_{l\times n} \\
= (\text{B}_{l\times n}^{line})^T \cdot \text{A}_{l\times n}\]</p><p>In the incidence matrix <span>$\text{A}_{l\times n}$</span> the row of line <span>$l$</span> contains the value +1 at the column of node <span>$n$</span> if the line starts at node <span>$n$</span> and the value <span>$-1$</span> if the line ends in node <span>$n$</span>, all other values are zero.</p><p>The diagonal elements of the <span>$\text{B}_{n \times m}^{bus}$</span> matrix contain the sum of all line susceptances of adjacent lines at node <span>$n$</span>. If there is a line from node <span>$n$</span> to node <span>$m$</span>, non-diagonal elements contain the value of the negative line susceptances, or zero if no connection exists.</p><p>Example for a simple three-node network:</p><p class="math-container">\[\text{B}_{l,l}^d = \nobreak
\begin{bmatrix}
 b_{l_1} &amp; 0 \\
 0 &amp; b_{l_2}
\end{bmatrix}
\text{A}_{l\times n} = \nobreak
\begin{bmatrix}
1 &amp; -1 &amp; 0 \\
0 &amp; 1 &amp; -1  
\end{bmatrix}
\text{B}_{l\times n}^{line} = \nobreak
\begin{bmatrix}
b_{l_1} &amp; -b_{l_1} &amp; 0 \\
0 &amp; b_{l_2} &amp; -b_{l_2}
\end{bmatrix}
\text{B}_{n \times m}^{bus} = \nobreak
\begin{bmatrix}
b_{l_1} &amp; -b_{l_1} &amp; 0 \\
-b_{l_1} &amp; b_{l_1} + b_{l_2} &amp; -b_{l_2}\\
0 &amp; -b_{l_2} &amp; b_{l_2}
\end{bmatrix}\]</p><p>The line directions in the incidence matrix may be chosen arbitrarily for this application, the direction only defines the sign of the power flow value.</p><h2 id="PTDF-Matrix-Formulation"><a class="docs-heading-anchor" href="#PTDF-Matrix-Formulation">PTDF-Matrix Formulation</a><a id="PTDF-Matrix-Formulation-1"></a><a class="docs-heading-anchor-permalink" href="#PTDF-Matrix-Formulation" title="Permalink"></a></h2><p>Removing the column and row corresponding to the slack node in the <span>$\text{B}_{n \times m}^{bus}$</span> matrix, the inverted matrix <span>$(\text{B}_{n \times m}^{bus})^{-1}$</span> may be used to solve for <span>$\theta$</span> to arrive at an alternative model formulation based on the power transfer distribution factor (PTDF) matrix. To ensure the Kirchhoff Current Law is still satisfied after the removal of the reference node, the following equation is added:</p><p class="math-container">\[PTDF_{l\times n} = \text{B}_{l\times n}^{line} \cdot (\text{B}_{n \times m}^{bus})^{-1} \\
F_l = \sum_n PTDF_{l\times n} \cdot INJ_n \qquad \forall l \in L \\
\sum_n INJ_n = 0\]</p><p><strong>References:</strong>  </p><ul><li><a href="https://api.semanticscholar.org/CorpusID:111125894">Van den Bergh, Delarue (2014)</a></li><li><a href="https://doi.org/10.1007/978-1-4615-4999-4_4">Monticelli (1999)</a>  </li><li><a href="https://hdl.handle.net/10419/129782">Egerer (2016)</a></li><li><a href="https://doi.org/10.1016/j.softx.2021.100870">Weinhold, Mieth (2021)</a></li></ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../market_model/">« Market Model</a><a class="docs-footer-nextpage" href="../Visualizing_inputs/">Visualizing inputs »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.10.1 on <span class="colophon-date" title="Thursday 24 July 2025 11:40">Thursday 24 July 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
